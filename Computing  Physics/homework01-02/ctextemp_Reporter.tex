\def\CTeXPreproc{Created by ctex v0.2.14, don't edit!}\documentclass[11pt,a4paper,titlepage,openany]{book}
\usepackage[space]{ctex}
\usepackage{mathrsfs,amssymb,amsfonts,amsmath,bm,ntheorem,graphicx}
\usepackage[paperwidth=185mm,paperheight=260mm,text={148mm,210mm},left=21mm,includehead,vmarginratio=1:1]{geometry}
\usepackage{fancyhdr,titlesec,enumerate}
\begin{document}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[EL,OR]{\thepage}
\fancyhead[OC]{\nouppercase{\heiti\rightmark}}
\fancyhead[EC]{\nouppercase{\heiti\leftmark}}
\fancypagestyle{plain}{\renewcommand{\headrulewidth}{0pt}\fancyhf{}}
\theoremstyle{plain}
\newcounter{Proposition}[section]
\newenvironment{Proposition}[1][]{{\par\normalfont\bfseries 命题~\stepcounter{Proposition}\arabic{Proposition}#1~~}\kaishu}{\par}
\newcounter{Corollary}[section]
\newenvironment{Corollary}[1][]{{\par\normalfont\bfseries 推论~\stepcounter{Corollary}\arabic{Corollary}#1~~}\kaishu}{\par}
\newcounter{Theorem}[section]
\newenvironment{Theorem}[1][]{{\par\normalfont\bfseries 定理~\stepcounter{Theorem}\arabic{Theorem}#1~~}\kaishu}{\par}
\newcounter{Lemma}[section]
\newenvironment{Lemma}[1][]{{\par\normalfont\bfseries 引理~\stepcounter{Lemma}\arabic{Lemma}#1~~}\kaishu}{\par}
\newcounter{Property}[section]
\newenvironment{Property}[1][]{{\par\normalfont\bfseries 性质~\stepcounter{Property}\arabic{Property}#1~~}\kaishu}{\par}
\newcounter{Assertion}[section]
\newenvironment{Assertion}[1][]{{\par\normalfont\bfseries 断语~\stepcounter{Assertion}\arabic{Assertion}#1~~}\kaishu}{\par}
\newenvironment{Proof}{{\par{\heiti 证明}~~}}{\hfill $\square$ \par\hfill\par}
\newcounter{Example}[section]
\newenvironment{Example}[1][]{{\par\normalfont\bfseries 例~\stepcounter{Example}\arabic{Example}#1~~}\songti}{\hfill\par\hfill\par}
\newcounter{Def}[section]
\newenvironment{Def}[1][]{{\par\normalfont\bfseries 定义~\stepcounter{Def}\arabic{Def}#1~~\songti}}{\par}
\newcounter{Note}[section]
\newenvironment{Note}[1][]{{\par\normalfont\bfseries 注~\stepcounter{Note}\arabic{Note}#1~~}\songti}{\par}
\title{{\zihao{0}\heiti Homework 01-02}}
\author{杨圣宇}
\maketitle
\chapter{算法分析}

\section{Schrage 算法生成随机数}
考虑到线性同余法的因子膨胀问题，在迭代多次后可能会使得在求模运算前溢出，$Schrage$ 算法正是被用来解决这样的问题\par
$Schrage$ 算法的思路是把同余运算，或者部分同余运算提前，利用同余分解，我们可以得到
$$m=aq+r, q=[\frac{m}{a}], r= m mod a$$
在比较常见的~16807 产生器中，对于 ~$m=2147483647, a=16807$，我们可以得到 ~$q=127773, r=2836$。
在一般的计算中，新的随机数由上一个随机数生成，我们记为 ~$z$，有 ~$az mod m$ 为我们想要的随机数，我们对 ~$az$ 做分解，有 ~$az=\dfrac{z}{q}(aq+r)-\dfrac{rz}{q}$，再分别对 ~$z$ 做同余分解，$$az=[\frac{z}{q}(aq+r)+\frac{z \mod q}{q}(aq+r)-r[\frac{z}{q}-r\frac{z mod q}{q}]$$
\end{document}
